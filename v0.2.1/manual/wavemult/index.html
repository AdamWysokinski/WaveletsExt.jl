<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Wavelets and Fast Numerical Algorithms · WaveletsExt.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">WaveletsExt.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../transforms/">Transforms</a></li><li><a class="tocitem" href="../bestbasis/">Best Basis</a></li><li><a class="tocitem" href="../denoising/">Denoising</a></li><li><a class="tocitem" href="../localdiscriminantbasis/">Local Discriminant Basis</a></li><li class="is-active"><a class="tocitem" href>Wavelets and Fast Numerical Algorithms</a><ul class="internal"><li><a class="tocitem" href="#Examples-and-Comparisons"><span>Examples and Comparisons</span></a></li></ul></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../api/dwt/">DWT</a></li><li><a class="tocitem" href="../../api/acwt/">ACWT</a></li><li><a class="tocitem" href="../../api/swt/">SWT</a></li><li><a class="tocitem" href="../../api/siwt/">SIWT</a></li><li><a class="tocitem" href="../../api/wavemult/">WaveMult</a></li><li><a class="tocitem" href="../../api/bestbasis/">Best Basis</a></li><li><a class="tocitem" href="../../api/denoising/">Denoising</a></li><li><a class="tocitem" href="../../api/ldb/">LDB</a></li><li><a class="tocitem" href="../../api/utils/">Utils</a></li><li><a class="tocitem" href="../../api/visualizations/">Visualizations</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Wavelets and Fast Numerical Algorithms</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Wavelets and Fast Numerical Algorithms</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/UCD4IDS/WaveletsExt.jl/blob/master/docs/src/manual/wavemult.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="wavemult_manual"><a class="docs-heading-anchor" href="#wavemult_manual">Fast Numerical Algorithms using Wavelet Transforms</a><a id="wavemult_manual-1"></a><a class="docs-heading-anchor-permalink" href="#wavemult_manual" title="Permalink"></a></h1><p>This demonstration is based on the paper <em><a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/cpa.3160440202">Fast wavelet transforms and numerical algorithms</a></em> by G. Beylkin, R. Coifman, and V. Rokhlin and the lecture notes <em><a href="https://arxiv.org/abs/comp-gas/9304004">Wavelets and Fast Numerical ALgorithms</a></em> by G. Beylkin.</p><p>Assume we have a matrix <span>$M \in \mathbb{R}^{n \times n}$</span>, and a vector <span>$x \in \mathbb{R}^n$</span>, there are two ways to compute <span>$y = Mx$</span>:  </p><ol><li>Use the regular matrix multiplication, which takes <span>$O(n^2)$</span> time.</li><li>Transform both <span>$M$</span> and <span>$x$</span> to their standard/nonstandard forms <span>$\tilde M$</span> and <span>$\tilde x$</span> respectively. Compute the multiplication of <span>$\tilde y = \tilde M \tilde x$</span>, then find the inverse of <span>$\tilde y$</span>.If the matrix <span>$\tilde M$</span> is sparse, this can take <span>$O(n)$</span> time.</li></ol><h2 id="Examples-and-Comparisons"><a class="docs-heading-anchor" href="#Examples-and-Comparisons">Examples and Comparisons</a><a id="Examples-and-Comparisons-1"></a><a class="docs-heading-anchor-permalink" href="#Examples-and-Comparisons" title="Permalink"></a></h2><p>In our following examples, we compare the methods described in the previous section. We focus on two important metrics: time taken and accuracy of the algorithm.</p><p>We start off by setting up the matrix <code>M</code>, the vector <code>x</code>, and the wavelet <code>wt</code>. As this algorithm is more efficient when <span>$n$</span> is large, we set <span>$n=2048$</span>.</p><pre><code class="language-julia hljs">using Wavelets, WaveletsExt, Random, LinearAlgebra, BenchmarkTools

# Construct matrix M, vector x, and wavelet wt
function data_setup(n::Integer, random_state = 1234)
    M = zeros(n,n)
    for i in axes(M,1)
        for j in axes(M,2)
            M[i,j] = i==j ? 0 : 1/abs(i-j)
        end
    end

    Random.seed!(random_state)
    x = randn(n)

    return M, x
end

M, x = data_setup(2048)
wt = wavelet(WT.haar)</code></pre><p>The following code block computes the regular matrix multiplication.</p><pre><code class="language-julia hljs">y₀ = M * x</code></pre><p>The following code block computes the nonstandard wavelet multiplication. Note that we will only be running 4 levels of wavelet transform, as running too many levels result in large computation time, without much improvement in accuracy.</p><pre><code class="language-julia hljs">L = 4
NM = mat2sparseform_nonstd(M, wt, L)
y₁ = nonstd_wavemult(NM, x, wt, L)</code></pre><p>The following code block computes the standard wavelet multiplication. Once again, we will only be running 4 levels of wavelet transform here.</p><pre><code class="language-julia hljs">SM = mat2sparseform_std(M, wt, L)
y₂ = std_wavemult(SM, x, wt, L)</code></pre><div class="admonition is-success"><header class="admonition-header">Performance Tip</header><div class="admonition-body"><p>Running more levels of transform (i.e. setting large values of <code>L</code>) does not necessarily result in more accurate approximations. Setting <code>L</code> to be a reasonably large value (e.g. 3 or 4) not only reduces computational time, but could also produce better results.</p></div></div><p>We assume that the regular matrix multiplication produces the true results (bar some negligible machine errors), and we compare our results from the nonstandard and standard wavelet multiplications based on their relative errors (<span>$\frac{||\hat y - y_0||_2}{||y_0||_2}$</span>).</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; relativenorm(y₁, y₀)       # Comparing nonstandard wavelet multiplication with true value</code><code class="nohighlight hljs ansi" style="display:block;">0.0015112400000964752</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; relativenorm(y₂, y₀)       # Comparing standard wavelet multiplication with true value</code><code class="nohighlight hljs ansi" style="display:block;">0.0010877481648021538</code></pre><p>Lastly, we compare the computation time for each algorithm.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; @benchmark $M * $x                          # Benchmark regular matrix multiplication</code><code class="nohighlight hljs ansi" style="display:block;">BenchmarkTools.Trial: 2129 samples with 1 evaluation.
 Range (min … max):  1.638 ms …  10.458 ms  ┊ GC (min … max): 0.00% … 0.00%
 Time  (median):     2.248 ms               ┊ GC (median):    0.00%
 Time  (mean ± σ):   2.320 ms ± 445.544 μs  ┊ GC (mean ± σ):  0.00% ± 0.00%

             ▂██▇▇▆▂▁
  ▂▂▂▂▃▂▂▃▄▅█████████▇▆▅▄▃▃▃▃▂▂▃▂▂▂▂▂▂▂▂▂▂▁▂▂▂▂▂▁▂▂▂▁▂▂▂▂▁▂▁▂ ▃
  1.64 ms         Histogram: frequency by time        4.04 ms &lt;

 Memory estimate: 16.12 KiB, allocs estimate: 1.</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; @benchmark nonstd_wavemult($NM, $x, $wt, L) # Benchmark nonstandard wavelet multiplication</code><code class="nohighlight hljs ansi" style="display:block;">BenchmarkTools.Trial: 10000 samples with 1 evaluation.
 Range (min … max):  269.601 μs …  12.535 ms  ┊ GC (min … max): 0.00% … 87.61%
 Time  (median):     290.101 μs               ┊ GC (median):    0.00%
 Time  (mean ± σ):   312.287 μs ± 338.284 μs  ┊ GC (mean ± σ):  2.69% ±  2.50%

     ▁▇██▇▆▅▄▃▁▁ ▁▁▂▂▂▂▂▁▁▁▁                                    ▂
  ▄▅▅███████████████████████████▇▇▆▇▆▆▆▇▆▆▆▆▆▅▇▇▇▆▆▇▅▆▆▅▅▅▅▅▅▄▄ █
  270 μs        Histogram: log(frequency) by time        451 μs &lt;

 Memory estimate: 129.19 KiB, allocs estimate: 28.</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; @benchmark std_wavemult($SM, $x, $wt, L)    # Benchmark standard wavelet multiplication</code><code class="nohighlight hljs ansi" style="display:block;">BenchmarkTools.Trial: 10000 samples with 1 evaluation.
 Range (min … max):  198.100 μs …  10.477 ms  ┊ GC (min … max): 0.00% … 89.49%
 Time  (median):     206.701 μs               ┊ GC (median):    0.00%
 Time  (mean ± σ):   220.090 μs ± 210.798 μs  ┊ GC (mean ± σ):  1.66% ±  1.80%

  ▅▇██▇▇▆▅▄▂▁     ▁▁▁▁▁▁▁▁                                      ▂
  ████████████▇▇▇▇████████▇███▇▇▇▇▇▇▇▇▇▆▆▅▆▆▆▃▅▆▆▅▆▆▅▆▅▅▅▅▄▃▃▅▅ █
  198 μs        Histogram: log(frequency) by time        335 μs &lt;

 Memory estimate: 65.14 KiB, allocs estimate: 13.</code></pre><p>As we can see above, the nonstandard and standard wavelet multiplication methods are significantly faster than the regular method and provides reasonable approximations to the true values.</p><div class="admonition is-success"><header class="admonition-header">Performance Tips</header><div class="admonition-body"><p>This method should only be used when the dimensions of <span>$M$</span> and <span>$x$</span> are large. Additionally, this would be more useful when one aims to compute <span>$Mx_0, Mx_1, \ldots, Mx_k$</span> where <span>$M$</span> remains constant throughout the <span>$k$</span> computations. In this case, it is more efficient to use </p><pre><code class="language-julia hljs">NM = mat2sparseform_nonstd(M, wt)
y = nonstd_wavemult(NM, x, wt)</code></pre><p>instead of</p><pre><code class="language-julia hljs">y = nonstd_wavemult(M, x, wt)</code></pre></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../localdiscriminantbasis/">« Local Discriminant Basis</a><a class="docs-footer-nextpage" href="../../api/dwt/">DWT »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.19 on <span class="colophon-date" title="Saturday 11 June 2022 04:26">Saturday 11 June 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
